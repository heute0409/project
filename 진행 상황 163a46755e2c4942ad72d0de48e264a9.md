# ì§„í–‰ ìƒí™©

# ğŸ’› 0629

---

## ë„ì „ ê³¼ì œ

PORORO OCR ì½”ë“œë¥¼ ì‚¬ìš©í•´ ì´ë¯¸ì§€ë¥¼ json íŒŒì¼ë¡œ ì €ì¥í•˜ê³ , ì´ê²ƒì„ í•¨ìˆ˜ë¡œ ë§Œë“ ë‹¤. bounding boxë¥¼ split í•˜ë„ë¡ PORORO OCR ì½”ë“œ ìˆ˜ì •. 

## ê³¼ì œ ë‚´ìš© ì„¤ëª…

1. ì£¼ì–´ì§„ ëª…í•¨ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ OCR ì½”ë“œë¥¼ ìˆ˜í–‰í•œ ì¶œë ¥ë¬¼ì„ json íŒŒì¼ë¡œ ì €ì¥í•œë‹¤. 

ì´ê²ƒì„ ì´í›„ í•™ìŠµì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ ë‘”ë‹¤. 

í•¨ìˆ˜ëŠ” ê°€ê¸‰ì  ê°€ì¥ ì‘ì€ ê¸°ëŠ¥ë§Œì„ ë‹´ë„ë¡ ì§œë„ë¡ í•œë‹¤. 

2. OCR ì½”ë“œë¥¼ ìˆ˜í–‰í•˜ë©´, bounding boxì˜ í¬ê¸°ê°€ ì„¬ì„¸í•˜ì§€ ì•Šì€ ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ ìš°ë¦¬ê°€ ì›í•˜ëŠ” í…ìŠ¤íŠ¸ ìš”ì†Œë¡œ split í•  ìˆ˜ ìˆë„ë¡ PORORO OCR ì½”ë“œ ìì²´ë¥¼ ìˆ˜ì •í•œë‹¤. 

## 1. í•¨ìˆ˜ ì œì‘

```python
from pororo import Pororo
import json
import os
import re
ocr = Pororo(task="ocr", lang="ko")
# img_path = "./source/ê¹€ê´‘ì—´.jpg"

def image():
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ jpg íŒŒì¼ì„ ì „ë¶€ ë°›ì•„ì˜¨ë‹¤ 
    path = "./source/"
    dir_list = os.listdir(path)
    dir_list_py = [file for file in dir_list if file.endswith('.jpg')]
    
    for i in dir_list_py : 
        img_path = path + i
        mk_json(save_list(img_path))

def save_list(img_path):
    #ì´ë¯¸ì§€ ocr ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    test_k = ocr(img_path, detail=True)
    listA=[]
    for i in range(len(test_k['bounding_poly'])):
        listA.append({"text":test_k['bounding_poly'][i]['description'],"box":test_k['bounding_poly'][i]['vertices'],"label":" ","id":" "})
    
    return (listA, img_path)

def mk_json(listA, img_path):
    name = re.split('[.,/]',img_path)[3]
    with open(f'./{name}.json','w',encoding='utf-8') as make_file :
        json.dump(listA,make_file,indent="\t")
```

![%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled.png](%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled.png)

ìœ„ì˜ ì½”ë“œë¥¼ ëŒë¦¬ë©´ ì‚¬ì§„ê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. 

`mk_json() missing 1 required positional argument: 'img_path'`

ì´ëŸ° ì˜¤ë¥˜ê°€ ìƒê¸°ëŠ” ì´ìœ ëŠ” ì´ì™€ ê°™ë‹¤.

```python
def save_list(img_path):
    #ì´ë¯¸ì§€ ocr ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    test_k = ocr(img_path, detail=True)
    listA=[]
    for i in range(len(test_k['bounding_poly'])):
        listA.append({"text":test_k['bounding_poly'][i]['description'],"box":test_k['bounding_poly'][i]['vertices'],"label":" ","id":" "})
    
    return (listA, img_path)

def mk_json(listA, img_path):
    name = re.split('[.,/]',img_path)[3]
    with open(f'./{name}.json','w',encoding='utf-8') as make_file :
        json.dump(listA,make_file,indent="\t")
```

`save_list()` í•¨ìˆ˜ì—ì„œ return ê°’ì¸ listA, img_pathëŠ” íŠœí”Œ ê°’ìœ¼ë¡œ 1ê°œë¼ê³  ìƒê°í•´ì•¼ í•œë‹¤. 

`mk_json()` í•¨ìˆ˜ì—ì„œëŠ” ë‘ ê°œì˜ input ê°’ì„ ì¨ì•¼ í•˜ëŠ”ë° ìœ„ì˜ ì½”ë“œë¡œ ì§„í–‰í•˜ë©´ listAì— (listA,img_path) íŠœí”Œ ê°’ì´ ë“¤ì–´ê°€ê³  img_path ê°’ì—ëŠ” ì•„ë¬´ê²ƒë„ ë“¤ì–´ê°€ì§€ ì•ŠëŠ”ë‹¤. 

(ê·¸ë˜ì„œ ì´ëŸ¬í•œ ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ return ê°’ì— ì—¬ëŸ¬ ê°œë¥¼ ë„£ì„ ë•ŒëŠ” í•­ìƒ ê´„í˜¸ë¡œ ê°ì‹¸ íŠœí”Œì„ì„ ì¸ì§€í•˜ë„ë¡ í•˜ì) 

ì´ê²ƒì„ ìˆ˜ì •í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ë“¤ì´ ìˆë‹¤. 

### 1. ìˆ˜ì • 1

```python
from pororo import Pororo
import json
import os
import re
ocr = Pororo(task="ocr", lang="ko")
# img_path = "./source/ê¹€ê´‘ì—´.jpg"

def image():
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ jpg íŒŒì¼ì„ ì „ë¶€ ë°›ì•„ì˜¨ë‹¤ 
    path = "./source/"
    dir_list = os.listdir(path)
    dir_list_py = [file for file in dir_list if file.endswith('.jpg')]
    
    for i in dir_list_py : 
        img_path = path + i
        mk_json(*save_list(img_path))

def save_list(img_path):
    #ì´ë¯¸ì§€ ocr ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    test_k = ocr(img_path, detail=True)
    listA=[]
    for i in range(len(test_k['bounding_poly'])):
        listA.append({"text":test_k['bounding_poly'][i]['description'],"box":test_k['bounding_poly'][i]['vertices'],"label":" ","id":" "})
    
    return (listA, img_path)

def mk_json(listA, img_path):
    name = re.split('[.,/]',img_path)[3]
    with open(f'./{name}.json','w',encoding='utf-8') as make_file :
        json.dump(listA,make_file,indent="\t")
```

`mk_json()` í•¨ìˆ˜ ì•ˆì— * ì„ ë„£ìœ¼ë©´ unpackì˜ íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. ê·¸ë˜ì„œ, return ê°’ì˜ listA, img_pathë¥¼ íŠœí”Œ 1ê°œ ê°’ì´ ì•„ë‹Œ 2ê°œ ë¦¬í„´ ê°’ìœ¼ë¡œ ë‹¤ìŒ í•¨ìˆ˜ì— ë„£ì„ ìˆ˜ ìˆë‹¤. 

### 2. ìˆ˜ì • 2

```python
from pororo import Pororo
import json
import os
import re
ocr = Pororo(task="ocr", lang="ko")
# img_path = "./source/ê¹€ê´‘ì—´.jpg"

def image():
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ jpg íŒŒì¼ì„ ì „ë¶€ ë°›ì•„ì˜¨ë‹¤ 
    path = "./source/"
    dir_list = os.listdir(path)
    dir_list_py = [file for file in dir_list if file.endswith('.jpg')]
    
    for i in dir_list_py : 
        img_path = path + i
        mk_json(save_list(img_path))

def save_list(img_path):
    #ì´ë¯¸ì§€ ocr ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    test_k = ocr(img_path, detail=True)
    listA=[]
    for i in range(len(test_k['bounding_poly'])):
        listA.append({"text":test_k['bounding_poly'][i]['description'],"box":test_k['bounding_poly'][i]['vertices'],"label":" ","id":" "})
    
    return (listA, img_path)

def mk_json(input):
		listA, img_path = input
    name = re.split('[.,/]',img_path)[3]
    with open(f'./{name}.json','w',encoding='utf-8') as make_file :
        json.dump(listA,make_file,indent="\t")
```

ì´ë ‡ê²Œ ì½”ë“œë¥¼ ë³€ê²½í•˜ë©´ listA, img_path=(íŠœí”Œ) ì˜ ì½”ë“œì—ì„œ unpackì˜ íš¨ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆë‹¤. 

ë‹¤ë¥¸ ìˆ˜ì • ë°©ë²•ìœ¼ë¡œëŠ” í•¨ìˆ˜ 2ê°œë¥¼ 1ê°œë¡œ í•©ì¹œ ê²ƒì´ ìˆìœ¼ë‚˜, ì‚¬ì‹¤ ì˜¤ë¥˜ì˜ ê·¼ë³¸ì ì¸ ì›ì¸ì„ ê³ ì¹œ ê²Œ ì•„ë‹ˆë¯€ë¡œ ìœ„ì˜ ë°©ë²•ì„ ìˆ™ì§€í•´ ë‘ë„ë¡ í•˜ì. 

```python
from pororo import Pororo
import json
import os
import re
ocr = Pororo(task="ocr", lang="ko")
# img_path = "./source/ê¹€ê´‘ì—´.jpg"

def image():
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ jpg íŒŒì¼ì„ ì „ë¶€ ë°›ì•„ì˜¨ë‹¤ 
    path = "./source/"
    dir_list = os.listdir(path)
    dir_list_py = [file for file in dir_list if file.endswith('.jpg')]
    
    for i in dir_list_py : 
        img_path = path + i
        save_list(img_path)

def save_list(img_path):
    #ì´ë¯¸ì§€ ocr ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    test_k = ocr(img_path, detail=True)
    listA=[]
    for i in range(len(test_k['bounding_poly'])):
        listA.append({"text":test_k['bounding_poly'][i]['description'],"box":test_k['bounding_poly'][i]['vertices'],"label":" ","id":" "})
    
    #json íŒŒì¼ë¡œ ë³€í™˜ 
    name = re.split('[.,/]',img_path)[3]
    with open(f'./{name}.json','w',encoding='utf-8') as make_file :
        json.dump(listA,make_file,indent="\t")
```

ë‹¤ìŒ ìƒê°í•´ ë³¼ ë‚´ìš© : `def image()`ì˜ í•¨ìˆ˜ì—ëŠ” inputê³¼ return ê°’ì´ ì •ì˜ë˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ, ì‚¬ì‹¤ìƒ ì½”ë“œë¥¼ í•¨ìˆ˜ë¥¼ ê°ì‹¼ ê²ƒ ì´ìƒì˜ íš¨ê³¼ê°€ ì—†ë‹¤. í•¨ìˆ˜ë¥¼ ë” í•¨ìˆ˜ì²˜ëŸ¼ ì“¸ ìˆ˜ ìˆë„ë¡ ìˆ˜ì •í•´ ë³´ì. (pathë¥¼ input ê°’ìœ¼ë¡œ ë„£ì„ ìˆ˜ ìˆê²Œ ê³ ì³ë³´ì.)

# ğŸ’› 0630

---

ì–´ë–¤ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê±´ í„°ë¯¸ë„ì—ì„œ `ctrl+J` ì—ì„œ pip listë¥¼ ì‚¬ìš©í•œë‹¤. 

í•œê¸€ ê¹¨ì§ í˜„ìƒì´ ë°œìƒí•˜ì—¬ ì½”ë“œë¥¼ ì¡°ê¸ˆ ìˆ˜ì •í–ˆë‹¤. 

```python
import json
import os
import re

ocr = Pororo(task="ocr", lang="ko")
# img_path = "./source/ê¹€ê´‘ì—´.jpg"

def image(PATH):
    # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ jpg íŒŒì¼ì„ ì „ë¶€ ë°›ì•„ì˜¨ë‹¤
    path = PATH
    dir_list = os.listdir(path)
    dir_list_py = [file for file in dir_list if file.endswith('.jpg')]
    
    for i in dir_list_py : 
        img_path = path + i
        mk_json(*save_list(img_path))

def save_list(img_path):
    #ì´ë¯¸ì§€ ocr ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥
    test_k = ocr(img_path, detail=True)
    listA=[]
    id = 1
    for i in range(len(test_k['bounding_poly'])):
        listA.append({"text":test_k['bounding_poly'][i]['description'],"box":test_k['bounding_poly'][i]['vertices'],"label":" ","id":id})
        id+=1
    
    return (listA, img_path)

def mk_json(listA, img_path):
    name = re.split('[.,/]',img_path)[3]
    with open(f'./Data/{name}.json','w',encoding='UTF-8-sig') as make_file :
        json.dump(listA,make_file,ensure_ascii=False,indent="\t")
```

ì¸ì½”ë”© ë°©ì‹ì„ UTF-8-sigë¡œ ë°”ê¾¸ê³ , ensure_ascii=False ì½”ë“œë¥¼ ì¶”ê°€í–ˆë‹¤. ë’¤ì˜ ì½”ë“œëŠ” ìœ ë‹ˆì½”ë“œ í˜•ì‹ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»ì´ë‹¤. 

ì´ì „ì— ourPororo íŒŒì¼ì˜ ìˆ˜ì • ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ from importë¥¼ ì—¬ëŸ¬ ë²ˆ í–ˆì—ˆëŠ”ë°, ì´ë²ˆì—ëŠ” kernel ì‘ë™ ìœ„ì¹˜ ìì²´ë¥¼ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— from pororo import Pororo ì½”ë“œë§Œ ì‚¬ìš©í•´ë„ ëŒì•„ê°€ê²Œ í–ˆë‹¤. 

## ìˆ˜ì • ì‚¬í•­

1. ë°•ì˜ˆì†” `[utils.py](http://utils.py)` íŒŒì¼ group_text_box() í•¨ìˆ˜ ìˆ˜ì • 

![%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%201.png](%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%201.png)

![%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%202.png](%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%202.png)

![%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%203.png](%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%203.png)

ìˆ˜ì • ì „í›„ 

2.  ë°°ì˜ˆì§„ get_paragraph() í•¨ìˆ˜ ìˆ˜ì • 

![%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%204.png](%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%204.png)

![%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%205.png](%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%92%E1%85%A2%E1%86%BC%20%E1%84%89%E1%85%A1%E1%86%BC%E1%84%92%E1%85%AA%E1%86%BC%20163a46755e2c4942ad72d0de48e264a9/Untitled%205.png)